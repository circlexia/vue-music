{"remainingRequest":"/Users/circle/Desktop/vue-music/node_modules/babel-loader/lib/index.js!/Users/circle/Desktop/vue-music/node_modules/eslint-loader/index.js??ref--13-0!/Users/circle/Desktop/vue-music/src/common/js/song.js","dependencies":[{"path":"/Users/circle/Desktop/vue-music/src/common/js/song.js","mtime":1574170630923},{"path":"/Users/circle/Desktop/vue-music/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/circle/Desktop/vue-music/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/circle/Desktop/vue-music/node_modules/eslint-loader/index.js","mtime":499162500000}],"contextDependencies":[],"result":["import \"core-js/modules/web.dom.iterable\";\nimport _Promise from \"/Users/circle/Desktop/vue-music/node_modules/@babel/runtime-corejs2/core-js/promise\";\nimport \"core-js/modules/es6.function.name\";\nimport _classCallCheck from \"/Users/circle/Desktop/vue-music/node_modules/@babel/runtime-corejs2/helpers/esm/classCallCheck\";\nimport _createClass from \"/Users/circle/Desktop/vue-music/node_modules/@babel/runtime-corejs2/helpers/esm/createClass\";\nimport { getLyric as _getLyric, getSongsUrl } from 'api/song';\nimport { ERR_OK } from 'api/config';\nimport { Base64 } from 'js-base64';\n\nvar Song =\n/*#__PURE__*/\nfunction () {\n  function Song(_ref) {\n    var id = _ref.id,\n        mid = _ref.mid,\n        singer = _ref.singer,\n        name = _ref.name,\n        album = _ref.album,\n        duration = _ref.duration,\n        image = _ref.image,\n        url = _ref.url;\n\n    _classCallCheck(this, Song);\n\n    this.id = id;\n    this.mid = mid;\n    this.singer = singer;\n    this.name = name;\n    this.album = album;\n    this.duration = duration;\n    this.image = image;\n    this.filename = \"C400\".concat(this.mid, \".m4a\");\n    this.url = url;\n  }\n\n  _createClass(Song, [{\n    key: \"getLyric\",\n    value: function getLyric() {\n      var _this = this;\n\n      if (this.lyric) {\n        return _Promise.resolve(this.lyric);\n      }\n\n      return new _Promise(function (resolve, reject) {\n        _getLyric(_this.mid).then(function (res) {\n          if (res.retcode === ERR_OK) {\n            _this.lyric = Base64.decode(res.lyric);\n            resolve(_this.lyric);\n          } else {\n            reject(new Error('no lyric'));\n          }\n        });\n      });\n    }\n  }]);\n\n  return Song;\n}();\n\nexport { Song as default };\nexport function createSong(musicData) {\n  return new Song({\n    id: musicData.songid,\n    mid: musicData.songmid,\n    singer: filterSinger(musicData.singer),\n    name: musicData.songname,\n    album: musicData.albumname,\n    duration: musicData.interval,\n    image: \"https://y.gtimg.cn/music/photo_new/T002R300x300M000\".concat(musicData.albummid, \".jpg?max_age=2592000\"),\n    url: musicData.url\n  });\n}\n\nfunction filterSinger(singer) {\n  var ret = [];\n\n  if (!singer) {\n    return '';\n  }\n\n  singer.forEach(function (s) {\n    ret.push(s.name);\n  });\n  return ret.join('/');\n}\n\nexport function isValidMusic(musicData) {\n  return musicData.songid && musicData.albummid && (!musicData.pay || musicData.pay.payalbumprice === 0);\n}\nexport function processSongsUrl(songs) {\n  if (!songs.length) {\n    return _Promise.resolve(songs);\n  }\n\n  return getSongsUrl(songs).then(function (purlMap) {\n    songs = songs.filter(function (song) {\n      var purl = purlMap[song.mid];\n\n      if (purl) {\n        song.url = purl.indexOf('http') === -1 ? \"http://dl.stream.qqmusic.qq.com/\".concat(purl) : purl;\n        return true;\n      }\n\n      return false;\n    });\n    return songs;\n  });\n}",{"version":3,"sources":["/Users/circle/Desktop/vue-music/src/common/js/song.js"],"names":["getLyric","getSongsUrl","ERR_OK","Base64","Song","id","mid","singer","name","album","duration","image","url","filename","lyric","resolve","reject","then","res","retcode","decode","Error","createSong","musicData","songid","songmid","filterSinger","songname","albumname","interval","albummid","ret","forEach","s","push","join","isValidMusic","pay","payalbumprice","processSongsUrl","songs","length","purlMap","filter","song","purl","indexOf"],"mappings":"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","sourcesContent":["import { getLyric, getSongsUrl } from 'api/song'\nimport { ERR_OK } from 'api/config'\nimport { Base64 } from 'js-base64'\n\nexport default class Song {\n  constructor ({ id, mid, singer, name, album, duration, image, url }) {\n    this.id = id\n    this.mid = mid\n    this.singer = singer\n    this.name = name\n    this.album = album\n    this.duration = duration\n    this.image = image\n    this.filename = `C400${this.mid}.m4a`\n    this.url = url\n  }\n\n  getLyric () {\n    if (this.lyric) {\n      return Promise.resolve(this.lyric)\n    }\n\n    return new Promise((resolve, reject) => {\n      getLyric(this.mid).then((res) => {\n        if (res.retcode === ERR_OK) {\n          this.lyric = Base64.decode(res.lyric)\n          resolve(this.lyric)\n        } else {\n          reject(new Error('no lyric'))\n        }\n      })\n    })\n  }\n}\n\nexport function createSong (musicData) {\n  return new Song({\n    id: musicData.songid,\n    mid: musicData.songmid,\n    singer: filterSinger(musicData.singer),\n    name: musicData.songname,\n    album: musicData.albumname,\n    duration: musicData.interval,\n    image: `https://y.gtimg.cn/music/photo_new/T002R300x300M000${musicData.albummid}.jpg?max_age=2592000`,\n    url: musicData.url\n  })\n}\n\nfunction filterSinger (singer) {\n  let ret = []\n  if (!singer) {\n    return ''\n  }\n  singer.forEach((s) => {\n    ret.push(s.name)\n  })\n  return ret.join('/')\n}\n\nexport function isValidMusic (musicData) {\n  return musicData.songid && musicData.albummid && (!musicData.pay || musicData.pay.payalbumprice === 0)\n}\n\nexport function processSongsUrl (songs) {\n  if (!songs.length) {\n    return Promise.resolve(songs)\n  }\n  return getSongsUrl(songs).then((purlMap) => {\n    songs = songs.filter((song) => {\n      const purl = purlMap[song.mid]\n      if (purl) {\n        song.url = purl.indexOf('http') === -1 ? `http://dl.stream.qqmusic.qq.com/${purl}` : purl\n        return true\n      }\n      return false\n    })\n    return songs\n  })\n}\n"]}]}